{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
      "ManagementGroupId":{
          "value": "Gap-HCF"
      },
      "forbiddenSysctls":{
          "value": [
              "kernel.msg*"
          ]
      },
      "allowedContainerPortsList":{
          "value": [
              "443",
              "80"
            ]
      },
      "allowedServicePortsList":{
          "value": [
              "443",
              "80"
            ]
      },
      "labelsList":{
          "value": []
      },
      "allowHostNetwork":{
          "value": true
      },
      "minPort":{
          "value": 1
      },
      "maxPort":{
          "value": 65535
      },
      "allowedVolumeTypes":{
          "value": [
              "configMap",
              "emptyDir",
              "secret",
              "persistentVolumeClaim"
          ]
      },
      "allowedProfiles":{
          "value": [
              "runtime/default"
          ]
      },
      "allowedCapabilities":{
          "value": [
              "CHOWN",
              "DAC_OVERRIDE",
              "FSETID",
              "FOWNER",
              "MKNOD",
              "NET_RAW",
              "SETGID",
              "SETUID",
              "SETFCAP",
              "SETPCAP",
              "NET_BIND_SERVICE",
              "SYS_CHROOT",
              "KILL",
              "AUDIT_WRITE"
          ]
      },
      "disallowedCapabilities":{
          "value": []
      },

      "AKS_Private_Clusters_should_enabled_effect":{
          "value": "Audit"
        },
        "not_allow_privileged_containers_effect":{
          "value": "audit"
        },
        "not_allow_container_privilege_escalation_effect":{
          "value": "audit"
        },
        "approved_host_network_and_port_range_effect":{
          "value": "audit"
        },
        "not_share_host_process_ID_or_host_IPC_namespace_effect":{
          "value": "audit"
        },
        "only_use_allowed_capabilities_effect":{
          "value": "audit"
        },
        "only_use_allowed_volume_types_effect":{
          "value": "audit"
        },
        "only_run_with_approved_user_and_group_IDs_effect":{
          "value": "audit"
        },
        "only_use_allowed_seccomp_profiles_effect":{
          "value": "audit"
        },
        "run_with_a_read_only_root_file_system_effect":{
          "value": "audit"
        },
        "CPU_and_memory_resource_limits_do_not_exceed.effect":{
          "value": "audit"
        },
        "allowed_container_images_effect":{
          "value": "audit"
        },
        "AKS_not_use_default_namespace_effect":{
          "value": "audit"
        },
        "AKS_not_use_specific_security_capabilities_effect":{
          "value": "audit"
        },
        "AKS_not_grant_CAP_SYS_ADMIN_security_capabilities_effect":{
          "value": "audit"
        },
        "AKS_disable_automounting_API_credentials_effect":{
          "value": "audit"
        },
        "AKS_nodepool_temp_disk_encrypted_effect":{
          "value": "Audit"
        },
        "AKS_should_use_internal_load_balancers_effect":{
          "value": "audit"
        },
        "AKS_should_accessible_only_over_HTTPS_effect":{
          "value": "audit"
        },
        "AKS_should_only_use_allowed_external_IPs_effect":{
          "value": "audit"
        },
        "AKS_should_listen_only_on_allowed_ports_effect":{
          "value": "audit"
        },
        "AKS_pods_should_use_specified_labels_effect":{
          "value": "audit"
        },
        "AKS_pods_containers_should_only_use_allowed_SELinux_options_effect":{
          "value": "deny"
        },
        "AKS_pod_hostPath_volumes_should_only_use_allowed_host_paths_effect":{
          "value": "audit"
        },
        "AKS_pod_FlexVolume_volumes_should_only_use_allowed_drivers_effect":{
          "value": "audit"
        },
        "AKS_containers_should_only_use_allowed_ProcMountType_effect":{
          "value": "deny"
        },
        "AKS_containers_should_only_listen_on_allowed_ports_effect":{
          "value": "audit"
        },
        "AKS_containers_should_not_use_forbidden_sysctl_interfaces_effect":{
          "value": "deny"
        },
        "Both_OS_and_data_disks_AKS_should_be_encrypted_by_customer_managed_key_effect":{
          "value": "Audit"
        },
        "Azure_Policy_Add-on_AKS_should_be_installed_and_enabled_effect":{
          "value": "Audit"
        },
        "AKS_Authorized_IP_range_effect":{
          "value": "Audit"
        },
        "AKS_cluster_containers_only_use_allowed_AppArmor_profiles_effect":{
          "value": "audit"
        },
        "AKS_should_upgraded_non-vulnerable_kubernetes_version_effect":{
          "value": "Audit"
        },
        "RBAC_should_used_on_AKS_effect":{
          "value": "Audit"
        },
    
        "not_allow_privileged_containers_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]
        },
        "not_allow_container_privilege_escalation_excludedNamespaces":{
            "value": [
              "kube-system",
              "gatekeeper-system",
              "azure-arc",
              "argo-rollouts",
              "cert-manager",
              "istio-gateway",
              "istio-system",
              "kube-node-lease"
            ]   
        },
        "approved_host_network_and_port_range_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]      
        },
        "not_share_host_process_ID_or_host_IPC_namespace_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "only_use_allowed_capabilities_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "only_use_allowed_volume_types_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "only_run_with_approved_user_and_group_IDs_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "only_use_allowed_seccomp_profiles_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "run_with_a_read_only_root_file_system_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "CPU_and_memory_resource_limits_do_not_exceed_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "allowed_container_images_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "AKS_not_use_default_namespace_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_not_use_specific_security_capabilities_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_not_grant_CAP_SYS_ADMIN_security_capabilities_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_disable_automounting_API_credentials_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "AKS_should_use_internal_load_balancers_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_should_accessible_only_over_HTTPS_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_should_only_use_allowed_external_IPs_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_should_listen_only_on_allowed_ports_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "AKS_pods_should_use_specified_labels_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_pods_containers_should_only_use_allowed_SELinux_options_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_pod_hostPath_volumes_should_only_use_allowed_host_paths_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "AKS_pod_FlexVolume_volumes_should_only_use_allowed_drivers_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_containers_should_only_use_allowed_ProcMountType_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_containers_should_only_listen_on_allowed_ports_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        },
        "AKS_containers_should_not_use_forbidden_sysctl_interfaces_excludedNamespaces":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc"
          ]     
        },
        "AKS_cluster_containers_only_use_allowed_AppArmor_profiles_excludeNameSpace":{
          "value": [
            "kube-system",
            "gatekeeper-system",
            "azure-arc",
            "argo-rollouts",
            "cert-manager",
            "istio-gateway",
            "istio-system",
            "kube-node-lease"
          ]     
        }
  }
}
